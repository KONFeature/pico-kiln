<!DOCTYPE html>
<html>
<head>
<title>Pico Kiln</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<h1>Pico Kiln Controller</h1>

<h2>SSR: {status}</h2>
<p>Current: {current_temp}C | Target: {target_temp}C | State: {state}</p>
<p>Program: {program}</p>

<h2>Profiles</h2>
{profiles_list}

<h2>Controls</h2>
<button onclick="location.reload()">Refresh</button>
<button onclick="stopProgram()">Stop Program</button>
<button onclick="emergencyShutdown()">Emergency Shutdown</button>
<br><br>
<button onclick="location.href='/tuning'">PID Tuning</button>

<hr>
<p><small>
<a href="/api/status">API Status</a> |
<a href="/api/state">API State</a> |
<a href="/api/info">API Info</a>
</small></p>

<script>
function startProfile(profileName) {
if (confirm('Start: ' + profileName + '?')) {
fetch('/api/run', {
method: 'POST',
headers: {'Content-Type': 'application/json'},
body: JSON.stringify({profile: profileName})
})
.then(r => r.json())
.then(d => {
alert(d.success ? 'Started: ' + profileName : 'Error: ' + d.error);
location.reload();
})
.catch(e => alert('Failed: ' + e));
}
}

function stopProgram() {
if (confirm('Stop current program?')) {
fetch('/api/stop', {method: 'POST'})
.then(r => r.json())
.then(d => {
alert(d.success ? 'Stopped' : 'Error: ' + d.error);
location.reload();
})
.catch(e => alert('Failed: ' + e));
}
}

function emergencyShutdown() {
if (confirm('EMERGENCY SHUTDOWN?')) {
fetch('/api/shutdown', {method: 'POST'})
.then(r => r.json())
.then(d => {
alert(d.message);
location.reload();
})
.catch(e => alert('Failed: ' + e));
}
}

setTimeout(() => location.reload(), 5000);
</script>
</body>
</html>
